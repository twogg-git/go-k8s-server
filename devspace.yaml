version: v1beta9
images:
  app:
    image: twogghub/goserver
    preferSyncOverRebuild: true
    injectRestartHelper: true
    appendDockerfileInstructions:
    - USER root
deployments:
- name: go-k8s-server
  kubectl:
    manifests:
    - k8s/worker/deployment.yaml
    - k8s/worker/service.yaml
    - k8s/worker/ingress.yaml
dev:
  sync:
  - imageName: app
    excludePaths:
    - .git/
    uploadExcludePaths:
    - .dockerignore
    - devspace.yaml
    onUpload:
      restartContainer: true
profiles:
- name: production
  description: ""
  patches:
  - op: remove
    path: images.app.appendDockerfileInstructions
  - op: remove
    path: images.app.injectRestartHelper
- name: interactive
  description: ""
  patches:
  - op: add
    path: dev.interactive
    value:
      defaultEnabled: true
  - op: add
    path: images.app.entrypoint
    value:
    - sleep
    - "9999999999"
